# The Python Geographic Visualizer (Geovis)
*Version: 0.1.0*

*Author: Karim Bahgat (karim.bahgat.norway@gmail.com)*

*Date: February 21, 2014*

*License: Creative Commons Attribution-ShareAlike (CC BY-SA). For more details see: http://creativecommons.org/licenses/by-sa/4.0/*

## Latest News
- 23 Feb. 2014: A little too quick on the trigger finger for the first release. Discovered and fixed a crucial import error. Also expanded the README file and converted it to markdown, and added autogenerated Wiki documentation. 
- 21 Feb. 2014: First rough version of code released (v0.1.0).


## Introduction

### About
The Python Geographic Visualizer (GeoVis) is a complete geographic visualization module for the Python programming language intended for easy everyday-use by novices and power-programmers alike. It has one-liners for quickly visualizing a shapefile, building and styling basic maps with multiple shapefile layers, and/or saving to imagefiles. Uses the built-in Tkinter or other third-party rendering modules to do its main work. The current version is functional, but should be considered a work in progress with potential bugs, so use with care.

### Dependencies
Technically speaking, GeoVis has no external dependencies, but it is highly recommended that you install the [Aggdraw](http://effbot.org/zone/aggdraw-index.htm), [PIL](http://www.pythonware.com/products/pil/) or [PyCairo](http://cairographics.org/pycairo/) renderer libraries to do the rendering. GeoVis automatically detects which renderer module you have and uses the first it finds in the following order (aggdraw, PIL, and pycairo). If you wish to manually choose a different renderer this has to be specified for each session. If none of these are available then GeoVis will default to using the built-in Tkinter Canvas as its renderer, but due to major limitations this is not recommended for viewing larger shapefiles. 

### Installation
No installation required, just use sys.path.append to the folder where the geovis folder is located or place the geovis folder in you Python site-packages folder, and import it using `import geovis`.

### System Compatibility
Should work on Python version 2.x and Windows. Has not yet been tested on Python 3.x or other OS systems.

### Known Problems
Current problems and limitations that I hope to change in future releases include:

- The shapefiles have to be in lat/long coordinates (i.e. unprojected) in order to be displayed correctly. That is, GeoVis does not yet handle projections or coordinate transformation.
- There is currently no way to zoom in to a certain extent, meaning that the visualizations always show the entire world (-180 to 180, and -90 to 90), which is unfortunate if your shapefiles are local or within-country-based. This shouldn't be too hard to fix in a future release however.
- Though plans are in the works to fix this, there are currently no built-in functions to automatically classify and visualize individual shapefile features based on their underlying data values. 
- I have not yet figured out how to pass PyCairo rendered images to the Tkinter window for viewing, so for now it results in an error. 

### Thanks To
GeoVis could not have been accomplished without the excellent work of other open-source modules which it uses behind-the-scenes: 

- For shapefile reading it uses a modified version of 
[Joel Lawhead’s PyShp module](http://code.google.com/p/pyshp/). 
- For color-wizardry it builds on and expands [Valentin Lab’s Colour module](https://pypi.python.org/pypi/colour). 
- And ofcourse it relies on the excellent rendering of whichever renderer you are using. 


## Basic Usage
This next section describes the basic functions and syntax of GeoVis. If you're unsure about or experiencing problems with a particular function you can look up the full documentation by typing `help(geovis)`, or by going online to [the GeoVis Wiki at Github](https://github.com/karimbahgat/geovis/wiki).

### Importing
Assuming you have already installed it as described in the Installation section, GeoVis is imported as:

```python
import geovis
```

### Choosing Your Renderer
If you do not have Aggdraw installed (which is the default renderer) then begin your script by changing to a renderer that you know you have, for instance PIL (if you have Numpy installed you might as well enable that for faster speed while you're at it):

```python
geovis.SetRenderingOptions(renderer="PIL", numpyspeed=True)
```

### Instant Mapping
If you are simply wanting to inspect some shapefile interactively, or for seeing how your processed shapefile turned out, then you do this with a simple one-liner:

```python
geovis.ViewShapefile("C:/shapefile.shp")
```

If you quickly want to show someone else your shapefile over email or on a forum you can just as easily save you map to an image either by clicking the "save image" button in the interactive window viewer or with the following line:

```python
geovis.SaveShapefileImage("C:/shapefile.shp",
                   savepath="C:/output_picture.png")
```

### Batch Map Creation
Sometimes it is necessary to quickly create a gallery of images of all your shapefiles in a given directory. GeoVis provides a general utility tool that can help you do this; it loops through, parses, and returns the foldername, filename, and extension of all shapefiles in a folder tree, which in turn can be used as input for the SaveShapefileImage function. So for instance we may write it as:

```python
for eachfolder, eachshapefile, eachfiletype in geovis.ShapefileFolder(r"D:\Test Data\GPS"):
    shapefilepath = eachfolder+eachshapefile+eachfiletype
    savetopath = "C:/Users/BIGKIMO/Desktop/mapgallery/"+eachshapefile+".png"
    geovis.SaveShapefileImage(shapefilepath, savetopath)
```

The filename, parent-folder, and file extension can be played around with to do many other batch operations as well, such as placing each map image next to (in the same folder as) each shapefile. 

### Adding Flavor to Your Map
The above quick methods used a set of default symbol options for the shapefiles that they rendered. There are however several ways to add more flavor to your map. The most basic stylizing tool you will want to know about is the Color creator (a wrapper around [Valentin Lab’s Colour module](https://pypi.python.org/pypi/colour) with added convenience functionality). You can either create a random color by not specifying any arguments:

```python
randomcolor = geovis.Color()
```

Or you can create a specific color the way you imagine it in your head by writing the color name and optionally tweaking the color intensity and brightness (float value between 0 and 1). Let's create a strong (high intensity) but dark (low brightness) red:

```python
strongdarkred = geovis.Color("red", intensity=0.8, brightness=0.2)
```

Alternatively, instead of creating a very specific color you can create a random color that still keeps within certain limits. This can be done because the color options that you do not specify are left to vary at random. This means that you can create any random color across, say, the spectrum of dark and weak colors by specifying a low brightness value and low intensity value but not specifying a color name, which will produce a random matte-looking color. Better yet, you can set the style argument to "matte" (among many other style names, see the documentation for the full list) which automatically chooses the brightness and intensity for you:

```python
randommattecolor = geovis.Color(style="matte")
```

Assuming you now know how to set your own colors or color styles, these colors are useful since they can be used to specify the color of any number of symbol options passed as keyword arguments to GeoVis' various rendering functions (see the documentation for a full list of changable symbol options). For instance, you may set the fillcolor of your shapefile polygons/lines/circles to our strong-dark-red from previously. In addition we will increase the outline width to match the strong fillcolor (we leave the outline *color* to its defaul black since this fits with the map):

```python
geovis.SetMapSymbols(fillcolor=strongdarkred,
            outlinewidth=5)
```

### Building Your Map From Scratch
However, if creating a visually appealing map is your goal then you are probably going to want to add additional shapefiles to the same map, in which case you will need to build your map from scratch. Let's decide to make it a pastelle themed map. Furthermore, to add to the pastelle theme of the map we specify that the ocean background should be a pastelle blue, rather than the default transparent color. Let's also make it a higher resolution map (the default is the pixel dimensions of your screen) so that one can zoom in and see all the details of your beautiful creation:

```python
geovis.SetMapDimensions(width=8000, height=4000)
geovis.SetMapBackground(geovis.Color("blue", style="pastelle")
newmap = geovis.NewMap()
newmap.AddToMap(polypath, fillcolor=geovis.Color(style="pastelle"))
newmap.AddToMap(pointpath, fillcolor=geovis.Color(style="pastelle"))
newmap.SaveMap("C:/Users/BIGKIMO/Desktop/custombuiltmap.png")
```

And that about covers the basic functionality of GeoVis. For a full list of all the functions and details on exactly how to use them see the documentation. Offcourse you can always experiment and combine these various functions in new ways to perform more advanced tasks. 

